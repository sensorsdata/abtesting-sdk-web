var _={},SensorsABTest={sd:null,lib_version:"0.0.2",para:{},default_para:{url:"",path:"",project_key:"",timeout_milliseconds:3e3,update_interval:6e5,collect_bridge_status:!0,session_limit:6e5},value_type_list:["Number","String","Object","Boolean"],state:{platform:"",storage:{isSupport:!0,name:"sawebjssdkabtest"}},bridgeState:"",localdata:{},originalData:[],triggerList:{},trackTestTrigger:function(e,t){var s=SensorsABTest.sd.store.getDistinctId(),i=!0,r=!0;if(t=_.isObject(t)?t:{},!e.is_white_list&&(this.triggerList&&_.isObject(this.triggerList)&&("{}"!==JSON.stringify(this.triggerList)&&(r=!1),this.triggerList[s]&&_.isArray(this.triggerList[s])&&_.each(this.triggerList[s],function(t){t===e.abtest_experiment_id&&(i=!1)})),i)){var a={$abtest_experiment_id:e.abtest_experiment_id,$abtest_experiment_group_id:e.abtest_experiment_group_id};if(SensorsABTest.para.collect_bridge_status&&(a.$sdk_bridge_status=SensorsABTest.bridgeState),r){var n="web_abtesting:"+this.lib_version;a.$lib_plugin_version=[n]}var o=_.extend(a,t);this.sd.track("$ABTestTrigger",o)}},verifyStore:{valueType:function(e,t){switch(t){case"Number":if(_.isNumber(e))return!0;break;case"String":if(_.isString(e))return!0;break;case"Object":if(_.isObject(e))return!0;break;case"Boolean":if(!0===e||!1===e)return!0;break;default:return!1}return!1},para:function(e,t,s){var i={verify_success:!0,para:null};return _.each(s,function(s,r){if("essential"===s)switch(r){case"param_name":_.isString(t.param_name)&&t.param_name.length>0||(SensorsABTest.error(e+"\u65b9\u6cd5\u8c03\u7528\u5931\u8d25\uff0cparam_name\u53c2\u6570\u672a\u6b63\u786e\u914d\u7f6e\uff01param_name:",t.param_name),i.verify_success=!1);break;case"value_type":_.isString(t.value_type)&&-1!==_.indexOf(SensorsABTest.value_type_list,t.value_type)||(SensorsABTest.error(e+"\u65b9\u6cd5\u8c03\u7528\u5931\u8d25\uff0cvalue_type\u914d\u7f6e\u9519\u8bef",t.value_type),i.verify_success=!1);break;case"default_value":"undefined"==typeof t.default_value?(SensorsABTest.error(e+"\u65b9\u6cd5\u8c03\u7528\u5931\u8d25\uff0cdefault_value\u53c2\u6570\u672a\u914d\u7f6e"),i.verify_success=!1):SensorsABTest.verifyStore.valueType(t.default_value,t.value_type)||(SensorsABTest.error(e+"\u65b9\u6cd5\u8c03\u7528\u5931\u8d25\uff0cdefault_value\u7c7b\u578b\u5fc5\u987b\u4e0evalue_type\u4e00\u81f4\uff01",t.default_value,t.value_type),i.verify_success=!1);break;case"callback":_.isFunction(t.callback)||(SensorsABTest.error(e+"\u65b9\u6cd5\u8c03\u7528\u5931\u8d25\uff0ccallback\u53c2\u6570\u672a\u6b63\u786e\u914d\u7f6e"),i.verify_success=!1);break;default:i.verify_success=!1}else if("not_essential"===s)switch(r){case"timeout_milliseconds":t.timeout_milliseconds=t.timeout_milliseconds||SensorsABTest.para.timeout_milliseconds||SensorsABTest.default_para.timeout_milliseconds,(!_.isNumber(t.timeout_milliseconds)||_.isNumber(t.timeout_milliseconds)&&t.timeout_milliseconds<=0)&&(_.log("timeout_milliseconds \u53c2\u6570\u9519\u8bef",t.timeout_milliseconds),t.timeout_milliseconds=SensorsABTest.para.timeout_milliseconds),t.timeout_milliseconds<200&&(t.timeout_milliseconds=200);break;case"properties":t.properties=_.isObject(t.properties)?t.properties:{}}}),i.para=t,i}},dealResponseData:function(e,t){_.isObject(e)?"SUCCESS"===e.status?_.isArray(e.results)&&(this.originalData=e.results,this.updateLocalData(e.results,t)):"FAILED"===e.status&&_.log("\u83b7\u53d6\u8bd5\u9a8c\u5931\u8d25\uff1aerror_type\uff1a"+e.error_type+",error\uff1a"+e.error):_.log("\u8bd5\u9a8c\u6570\u636e\u89e3\u6790\u5931\u8d25\uff0cresponse \uff1a",e)},getRelativeValue:function(e,t){var s={},i={INTEGER:function(e){var t=parseFloat(e);isNaN(t)?_.log("\u539f\u59cb\u6570\u636e INTEGER \u7c7b\u578b\u89e3\u6790\u5f02\u5e38",e):(s.value=t,s.type="Number")},STRING:function(e){_.isString(e)?(s.value=e,s.type="String"):_.log("\u539f\u59cb\u6570\u636e STRING \u7c7b\u578b\u89e3\u6790\u5f02\u5e38",e)},JSON:function(e){var t=JSON.parse(e);_.isObject(t)?(s.value=t,s.type="Object"):_.log("\u539f\u59cb\u6570\u636e JSON \u7c7b\u578b\u89e3\u6790\u5f02\u5e38",e)},BOOLEAN:function(e){"true"===e?(s.value=!0,s.type="Boolean"):"false"===e?(s.value=!1,s.type="Boolean"):_.log("\u539f\u59cb\u6570\u636e BOOLEAN \u7c7b\u578b\u89e3\u6790\u5f02\u5e38",e)}};try{i[t]?i[t](e):_.log("\u8bd5\u9a8c\u6570\u636e\u7c7b\u578b\u89e3\u6790\u5931\u8d25",t,e)}catch(r){_.log(r,e,t)}return s},updateLocalData:function(e,t){this.analyzeData(e),this.updateStorage(t),_.log("\u66f4\u65b0\u8bd5\u9a8c\u6570\u636e\u6210\u529f")},updateStorage:function(e){var t=(new Date).getTime(),s={data:this.originalData,updateTime:t,triggerList:this.triggerList,distinct_id:e||SensorsABTest.sd.store.getDistinctId()};this.setStorageData(s)},analyzeData:function(e){var t=this;if(!_.isArray(e))return _.log("\u89e3\u6790——\u6570\u636e\u683c\u5f0f\u9519\u8bef",e),!1;this.localdata={},_.each(e,function(e){_.isObject(e)&&e.variables&&_.isArray(e.variables)&&_.each(e.variables,function(s){_.isObject(s)&&!t.localdata[s.name]&&(t.localdata[s.name]={abtest_experiment_id:e.abtest_experiment_id,abtest_experiment_group_id:e.abtest_experiment_group_id,is_control_group:e.is_control_group,is_white_list:e.is_white_list,value:s.value,type:s.type,js_config:SensorsABTest.getRelativeValue(s.value,s.type)})})})},initMethods:function(e){_.each(["asyncFetchABTest","fastFetchABTest","fetchCacheABTest"],function(t){SensorsABTest[t]=e.methods[t]})},asyncFetchABTest:function(){SensorsABTest.error("asyncFetchABTest\u8c03\u7528\u5931\u8d25,A/B Testing\u672a\u521d\u59cb\u5316")},fastFetchABTest:function(){SensorsABTest.error("fastFetchABTest\u8c03\u7528\u5931\u8d25,A/B Testing\u672a\u521d\u59cb\u5316")},fetchCacheABTest:function(){SensorsABTest.error("fetchCacheABTest\u8c03\u7528\u5931\u8d25,A/B Testing\u672a\u521d\u59cb\u5316")},searchLocalExp:function(e){return SensorsABTest.localdata[e]?SensorsABTest.localdata[e]:null},getExpResult:function(e,t){var s=e.default_value,i=t||SensorsABTest.searchLocalExp(e.param_name);return _.isObject(i)?_.isObject(i.js_config)&&(i.js_config.type===e.value_type?(s=i.js_config.value,this.triggerHandle(i,e)):this.log("\u8bd5\u9a8c\u7ed3\u679c\u7c7b\u578b\u4e0e\u4ee3\u7801\u671f\u671b\u7c7b\u578b\u4e0d\u4e00\u81f4\uff0cparam_name\uff1a"+e.param_name+"\uff0c\u5f53\u524d\u8fd4\u56de\u7c7b\u578b\u4e3a\uff1a"+i.js_config.type+"\uff0c\u4ee3\u7801\u671f\u671b\u7c7b\u578b\u4e3a\uff1a"+e.value_type)):this.log("localdata\u672a\u67e5\u8be2\u5230\u8bd5\u9a8c\u6570\u636e\uff0c\u8bd5\u9a8c\u53c2\u6570\u540d\u79f0\uff1a"+e.param_name),s},triggerHandle:function(e,t){SensorsABTest.trackTestTrigger(e,t.properties);var s=e.abtest_experiment_id;if(_.isString(s)){var i=SensorsABTest.sd.store.getDistinctId();this.triggerList[i]&&_.isArray(this.triggerList[i])?(this.triggerList[i].push(s),this.triggerList[i]=_.unique(this.triggerList[i])):this.triggerList[i]=[s],this.updateStorage()}},getSA:function(e){return!!(_.isObject(e)&&_.isObject(e.readyState)&&e.readyState.state>=3)&&(this.sd=e,!0)},log:function(){if("object"==typeof console&&console.log){_.isString(arguments[0])&&(arguments[0]="sensorsabtest————"+arguments[0]);try{return console.log.apply(console,arguments)}catch(e){console.log(arguments[0])}}},error:function(){if("object"==typeof console&&console.error)try{return console.error.apply(console,arguments)}catch(e){console.error(arguments[0])}},checkSADebug:function(){var e=_.getQueryParam(location.href,"sensors_abtest_url"),t=_.getQueryParam(location.href,"feature_code"),s=+_.getQueryParam(location.href,"account_id");if(e.length&&t.length&&_.isNumber(s)&&0!==s){var i={distinct_id:SensorsABTest.sd.store.getDistinctId(),feature_code:t,account_id:s};_.ajax({url:e,type:"POST",data:JSON.stringify(i),credentials:!1,contentType:"application/json",timeout:SensorsABTest.para.timeout_milliseconds,cors:!0,success:function(){},error:function(e){_.log("distinct_id\u53d1\u9001\u5931\u8d25,err:",e)}})}},listenPageState:function(e){({visibleHandle:_.isFunction(e.visible)?e.visible:function(){},hiddenHandler:_.isFunction(e.hidden)?e.hidden:function(){},visibilityChange:null,hidden:null,isSupport:function(){return"undefined"!=typeof document[this.hidden]},init:function(){"undefined"!=typeof document.hidden?(this.hidden="hidden",this.visibilityChange="visibilitychange"):"undefined"!=typeof document.mozHidden?(this.hidden="mozHidden",this.visibilityChange="mozvisibilitychange"):"undefined"!=typeof document.msHidden?(this.hidden="msHidden",this.visibilityChange="msvisibilitychange"):"undefined"!=typeof document.webkitHidden&&(this.hidden="webkitHidden",this.visibilityChange="webkitvisibilitychange"),this.listen()},listen:function(){if(this.isSupport()){var e=this;document.addEventListener(e.visibilityChange,function(){document[e.hidden]?e.hiddenHandler():e.visibleHandle()},1)}else document.addEventListener?(window.addEventListener("focus",this.visibleHandle,1),window.addEventListener("blur",this.hiddenHandler,1)):(document.attachEvent("onfocusin",this.visibleHandle),document.attachEvent("onfocusout",this.hiddenHandler))}}).init()},storage:{set:function(e,t){SensorsABTest.state.storage.isSupport&&window.localStorage.setItem(t,JSON.stringify(e))},get:function(e){var t=null;SensorsABTest.state.storage.isSupport&&(t=window.localStorage.getItem(e));try{t=JSON.parse(t)}catch(s){_.log(s)}return t}},getStorageData:function(){return this.storage.get(SensorsABTest.state.storage.name)},setStorageData:function(e){this.storage.set(e,SensorsABTest.state.storage.name)},fetchData:{timer:null,method:null,context:null,init:function(e,t){this.method=e,this.context=t,this.start(!0)},getServerData:function(){this.method.call(this.context)},setNextFetch:function(e){var t=this,s=e||SensorsABTest.para.update_interval;this.clearFetchTimer(this.timer),this.timer=setTimeout(function(){t.getServerData()},s)},start:function(e){var t=null,s=(new Date).getTime(),i=SensorsABTest.getStorageData(),r=SensorsABTest.sd.store.getDistinctId();if(i&&_.isObject(i)&&i.distinct_id===r)if(t=i.updateTime,e&&(SensorsABTest.originalData=i.data,SensorsABTest.analyzeData(i.data),t&&_.isNumber(t)&&s-t>0&&s-t<SensorsABTest.para.session_limit&&_.isObject(i.triggerList)&&(SensorsABTest.triggerList=i.triggerList)),t&&_.isNumber(t)&&s-t>0&&s-t<SensorsABTest.para.update_interval){_.log("\u6570\u636e\u4e0d\u66f4\u65b0",t,s);var a=s-t,n=SensorsABTest.para.update_interval-a;this.setNextFetch(n)}else _.log("\u7f13\u5b58\u6570\u636e\u8d85\u65f6",t,s),this.getServerData();else this.getServerData()},stop:function(){_.log("\u6e05\u7a7a\u62c9\u53d6\u5b9a\u65f6\u5668"),this.clearFetchTimer()},clearFetchTimer:function(){clearTimeout(this.timer),this.timer=null}},init:function(e,t){return this.sd?(this.log("A/B Testing SDK \u91cd\u590d\u521d\u59cb\u5316\uff01\u53ea\u6709\u7b2c\u4e00\u6b21\u521d\u59cb\u5316\u6709\u6548\uff01"),!1):((_=e._).log=function(){return _.isString(arguments[0])&&(arguments[0]="sensorsabtest————"+arguments[0]),e.log.apply(this,arguments)},this.getSA(e)?_.isObject(t)?("object"==typeof localStorage&&this.sd._.localStorage.isSupport()||(_.log("localstorage\u5f02\u5e38"),this.state.storage.isSupport=!1),void(e.bridge.is_verify_success?this.bridgeStore.init(t):this.normalStore.init(t))):(_.log("A/B Testing SDK \u521d\u59cb\u5316\u5931\u8d25\uff0c\u8bf7\u4f20\u5165\u6b63\u786e\u7684\u521d\u59cb\u5316\u53c2\u6570!para:",t),!1):(this.log("A/B Testing \u521d\u59cb\u5316\u5931\u8d25,Web JS SDK \u6ca1\u6709\u521d\u59cb\u5316\u5b8c\u6210"),!1))},store:{init:function(e,t){SensorsABTest.fetchData.init(e,t),SensorsABTest.initMethods(t),SensorsABTest.listenPageState({visible:function(){_.log("\u9875\u9762\u663e\u793a"),SensorsABTest.fetchData.start()},hidden:function(){SensorsABTest.fetchData.stop()}}),SensorsABTest.sd.events.on("changeDistinctId",function(e){SensorsABTest.localdata={},SensorsABTest.originalData=[],SensorsABTest.updateStorage(),SensorsABTest.fetchData.getServerData()}),SensorsABTest.sd.events.isReady()}},bridgeStore:{init:function(e){if(!this.setPara(e))return!1;_.log("A/B Testing SDK \u521d\u59cb\u5316\u6210\u529f"),SensorsABTest.state.storage.name="sawebjssdkabtest_bridge",SensorsABTest.abBridge=new SensorsABTest.sd.JSBridge({type:"abtest",app_call_js:function(e){try{e=_.base64Decode(e)}catch(t){_.log("App\u6570\u636ebase64\u89e3\u7801\u5f02\u5e38",e)}try{(e=JSON.parse(e)).message_id&&this.double(e)}catch(t){_.log("App\u6570\u636e\u89e3\u6790\u5f02\u5e38",e)}}}),_.isObject(window.SensorsData_iOS_JS_Bridge)&&window.SensorsData_iOS_JS_Bridge.sensorsdata_abtest_module&&SensorsABTest.abBridge.hasAppBridge()?SensorsABTest.bridgeState="ab_bridge_ok":_.isObject(window.SensorsData_APP_New_H5_Bridge)&&_.isFunction(window.SensorsData_APP_New_H5_Bridge.sensorsdata_abtest_module)&&window.SensorsData_APP_New_H5_Bridge.sensorsdata_abtest_module()&&SensorsABTest.abBridge.hasAppBridge()?SensorsABTest.bridgeState="ab_bridge_ok":SensorsABTest.bridgeState="ab_no_abtest_bridge",SensorsABTest.store.init(this.getResultFromApp,this)},setPara:function(e){var t=SensorsABTest.verifyStore.para("\u6253\u901a\u521d\u59cb\u5316",e,{timeout_milliseconds:"not_essential"});return SensorsABTest.para=_.extend({},SensorsABTest.default_para,t.para),_.isBoolean(SensorsABTest.para.collect_bridge_status)||(SensorsABTest.para.collect_bridge_status=!0),_.isNumber(SensorsABTest.para.update_interval)||(SensorsABTest.para.update_interval=6e5),!0},getResultFromApp:function(e){var t=(e=_.isObject(e)?e:{}).para||{},s=e.suc,i=e.err,r=t.timeout_milliseconds||SensorsABTest.para.timeout_milliseconds;_.log("\u5411App\u53d1\u8d77\u8bd5\u9a8c\u8bf7\u6c42"),"ab_bridge_ok"===SensorsABTest.bridgeState?SensorsABTest.abBridge.requestToApp({data:{properties:t.properties,timeout:r},callback:function(e){_.isObject(e)&&_.isObject(e.data)?(_.log("\u6210\u529f\u83b7\u53d6\u5230 App \u7aef\u8fd4\u56de\u7684\u8bd5\u9a8c\u6570\u636e","data:",e),SensorsABTest.dealResponseData(e.data),s&&s(e)):(_.log("App \u7aef\u8bf7\u6c42\u5931\u8d25"),i&&i()),SensorsABTest.fetchData.setNextFetch()},timeout:{time:r,callback:function(){_.log("\u83b7\u53d6App\u7aef\u6570\u636e\u5931\u8d25"),i&&i(),SensorsABTest.fetchData.setNextFetch()}}}):i&&(_.log("A/B Testing \u6253\u901a\u5931\u8d25\uff0c",SensorsABTest.bridgeState),i())},asyncFetch:function(e){SensorsABTest.bridgeStore.getResultFromApp({para:e,suc:function(t){if(_.isObject(t.properties)&&(e.properties=_.extend(t.properties,e.properties)),"SUCCESS"===t.data.status){var s=SensorsABTest.getExpResult(e);e.callback(s)}else e.callback(e.default_value)},err:function(){e.callback(e.default_value)}})},methods:{asyncFetchABTest:function(e){if(!_.isObject(e))return SensorsABTest.error("asyncFetchABTest\u8c03\u7528\u5931\u8d25\uff0c\u53c2\u6570\u672a\u6b63\u786e\u914d\u7f6e"),!1;var t=SensorsABTest.verifyStore.para("asyncFetchABTest",e,{param_name:"essential",value_type:"essential",default_value:"essential",callback:"essential",timeout_milliseconds:"not_essential",properties:"not_essential"});t.verify_success&&(e=t.para,"ab_bridge_ok"===SensorsABTest.bridgeState?SensorsABTest.bridgeStore.asyncFetch(e):e.callback(e.default_value))},fastFetchABTest:function(e){if(!_.isObject(e))return SensorsABTest.error("fastFetchABTest\u8c03\u7528\u5931\u8d25\uff0c\u53c2\u6570\u672a\u6b63\u786e\u914d\u7f6e"),!1;var t=SensorsABTest.verifyStore.para("fastFetchABTest",e,{param_name:"essential",value_type:"essential",default_value:"essential",callback:"essential",timeout_milliseconds:"not_essential",properties:"not_essential"});if(t.verify_success){e=t.para;var s=SensorsABTest.searchLocalExp(e.param_name);if(_.isObject(s)){var i=SensorsABTest.getExpResult(e,s);e.callback(i)}else _.log("fastFetchABTest\u7f13\u5b58\u4e2d\u672a\u8bfb\u53d6\u5230\u6570\u636e\uff0c\u53d1\u8d77\u8bf7\u6c42"),"ab_bridge_ok"===SensorsABTest.bridgeState?SensorsABTest.bridgeStore.asyncFetch(e):e.callback(e.default_value)}},fetchCacheABTest:function(e){if(_.isObject(e)){var t=SensorsABTest.verifyStore.para("fetchCacheABTest",e,{param_name:"essential",value_type:"essential",default_value:"essential"});if(t.verify_success)return SensorsABTest.getExpResult(t.para)}else SensorsABTest.error("fetchCacheABTest\u8c03\u7528\u5931\u8d25\uff0c\u53c2\u6570\u672a\u6b63\u786e\u914d\u7f6e")}}},normalStore:{init:function(e){if(!this.setPara(e))return!1;SensorsABTest.bridgeState="ab_no_host_bridge",/Android|webOS|iPhone|iPod|BlackBerry/i.test(navigator.userAgent)?SensorsABTest.state.platform="H5":SensorsABTest.state.platform="Web",_.log("A/B Testing SDK \u521d\u59cb\u5316\u6210\u529f\uff0c\u8bd5\u9a8c URL\uff1a",e.url),SensorsABTest.checkSADebug(),SensorsABTest.store.init(this.getResultFromServer,this)},setPara:function(e){if(!_.isString(e.url)||"http"!==e.url.slice(0,4))return _.log("A/B Testing SDK \u521d\u59cb\u5316\u5931\u8d25\uff0c\u8bf7\u4f7f\u7528\u6b63\u786e\u7684 URL\uff01"),!1;if("https"===location.protocol.slice(0,4)&&"http"===e.url.slice(0,4))return _.log("A/B Testing SDK \u521d\u59cb\u5316\u5931\u8d25\uff0chttps \u9875\u9762\u5fc5\u987b\u4f7f\u7528 https \u7684 URL"),!1;var t=_.getQueryParam(e.url,"project-key");if(!t)return _.log("A/B Testing SDK \u521d\u59cb\u5316\u5931\u8d25\uff0c\u8bf7\u4f7f\u7528\u6b63\u786e\u7684 URL\uff08\u5fc5\u987b\u5305\u542b project-key\uff09\uff01"),!1;e.project_key=t;var s=SensorsABTest.verifyStore.para("A/B Testing SDK \u521d\u59cb\u5316",e,{timeout_milliseconds:"not_essential"});return SensorsABTest.para=_.extend({},SensorsABTest.default_para,s.para),_.isBoolean(SensorsABTest.para.collect_bridge_status)||(SensorsABTest.para.collect_bridge_status=!0),_.isNumber(SensorsABTest.para.update_interval)||(SensorsABTest.para.update_interval=6e5),!0},asyncFetch:function(e){SensorsABTest.normalStore.getResultFromServer({para:e,suc:function(t){if(_.isObject(t)&&"SUCCESS"===t.status){var s=SensorsABTest.getExpResult(e);e.callback(s)}else e.callback(e.default_value)},err:function(){e.callback(e.default_value)}})},methods:{asyncFetchABTest:function(e){if(!_.isObject(e))return SensorsABTest.error("asyncFetchABTest\u8c03\u7528\u5931\u8d25\uff0c\u53c2\u6570\u672a\u6b63\u786e\u914d\u7f6e"),!1;var t=SensorsABTest.verifyStore.para("asyncFetchABTest",e,{param_name:"essential",value_type:"essential",default_value:"essential",callback:"essential",timeout_milliseconds:"not_essential",properties:"not_essential"});t.verify_success&&(e=t.para,SensorsABTest.normalStore.asyncFetch(e))},fastFetchABTest:function(e){if(!_.isObject(e))return SensorsABTest.error("fastFetchABTest\u8c03\u7528\u5931\u8d25\uff0c\u53c2\u6570\u672a\u6b63\u786e\u914d\u7f6e"),!1;var t=SensorsABTest.verifyStore.para("fastFetchABTest",e,{param_name:"essential",value_type:"essential",default_value:"essential",callback:"essential",timeout_milliseconds:"not_essential",properties:"not_essential"});if(t.verify_success){e=t.para;var s=SensorsABTest.searchLocalExp(e.param_name);if(_.isObject(s)){var i=SensorsABTest.getExpResult(e,s);e.callback(i)}else _.log("fastFetchABTest\u7f13\u5b58\u4e2d\u672a\u8bfb\u53d6\u5230\u6570\u636e\uff0c\u53d1\u8d77\u8bf7\u6c42"),SensorsABTest.normalStore.asyncFetch(e)}},fetchCacheABTest:function(e){if(_.isObject(e)){var t=SensorsABTest.verifyStore.para("fetchCacheABTest",e,{param_name:"essential",value_type:"essential",default_value:"essential"});if(t.verify_success)return SensorsABTest.getExpResult(t.para)}else SensorsABTest.error("fetchCacheABTest\u8c03\u7528\u5931\u8d25\uff0c\u53c2\u6570\u672a\u6b63\u786e\u914d\u7f6e")}},creatRequestData:function(e){var t="";_.isEmptyObject(SensorsABTest.sd.store._state)||(t=SensorsABTest.sd.store._state._first_id||SensorsABTest.sd.store._state.first_id||SensorsABTest.sd.store._state._distinct_id||SensorsABTest.sd.store._state.distinct_id);var s={anonymous_id:t,platform:SensorsABTest.state.platform,abtest_lib_version:SensorsABTest.lib_version,properties:{$is_first_day:_.cookie.getNewUser()}};return _.isObject(e.properties)&&(s.properties=_.extend({},s.properties,e.properties)),SensorsABTest.sd.store._state.first_id&&(s.login_id=SensorsABTest.sd.store.getDistinctId()),s},getResultFromServer:function(e){var t,s=(e=_.isObject(e)?e:{}).para||{},i=e.suc,r=e.err,a=this.creatRequestData(s);_.log("\u5411\u670d\u52a1\u7aef\u53d1\u8d77\u8bd5\u9a8c\u8bf7\u6c42"),t=SensorsABTest.sd.store.getDistinctId(),_.ajax({url:SensorsABTest.para.url,type:"POST",data:JSON.stringify(a),credentials:!1,contentType:"application/json",timeout:s.timeout_milliseconds||SensorsABTest.para.timeout_milliseconds,cors:!0,success:function(e){SensorsABTest.dealResponseData(e,t),i&&i(e),SensorsABTest.fetchData.setNextFetch()},error:function(e){_.log("\u670d\u52a1\u7aef\u8bf7\u6c42\u53d1\u9001\u5931\u8d25",e),r&&r(),SensorsABTest.fetchData.setNextFetch()}})}}};window.SensorsDataWebJSSDKPlugin&&"[object Object]"==Object.prototype.toString.call(window.SensorsDataWebJSSDKPlugin)?window.SensorsDataWebJSSDKPlugin.SensorsABTest=window.SensorsDataWebJSSDKPlugin.SensorsABTest||SensorsABTest:window.SensorsDataWebJSSDKPlugin={SensorsABTest:SensorsABTest};export default SensorsABTest;